
Function SelectStartAmount(DataSheet As Integer, ReportSheet As Integer)
'
' This is to select the last amount from MonedaNacional
' The idea is to have a start point (amount of money)
'
'
  Dim InitialAmount As Double
  InitialAmount = Sheets(DataSheet).range("G3")

  Sheets(ReportSheet).Select
  range("C35").Value = InitialAmount
End Function

Function MonthsTitle()
'
' MonthsTitle Macro
' This should set for how many months the calculation is going to be done

' This Methos also sets the InitialAmount rule for each Month as well as
' the total calculation (add / substract) per each month

    Dim starDate As Date
    Dim endDate As Date
    
    startDate = range("E2").Value
    endDate = range("E3").Value
    
    Dim counter  As Integer, initialColumn As Integer, tempDate As Date
    counter = 0
    initialColumn = 6
    tempDate = startDate
    
    Do While tempDate <= endDate
      ' month title
      Cells(5, (initialColumn + counter)).Value = Format(tempDate, "mmm")
      
      ' initial month amount
      If counter = 0 Then
        range("F6").FormulaR1C1 = "=R35C3"
      Else
        Cells(6, (initialColumn + counter)).FormulaR1C1 = Cells(31, (initialColumn + counter - 1))
      End If
      
      ' end month amount
      Cells(31, (initialColumn + counter)).Value = "=SUM(" _
          & range(Cells(6, (initialColumn + counter)), Cells(9, (initialColumn + counter))).Address(False, False) & ")" _
          & " - SUM(" _
          & range(Cells(10, (initialColumn + counter)), Cells(30, (initialColumn + counter))).Address(False, False) & ")"
      
      counter = counter + 1
      tempDate = DateSerial(Year(tempDate), Month(tempDate) + 1, Day(tempDate))
    Loop
    
End Function

Function Populate(DataSheet, ReportSheet)
'
' This method gets all the types of "Cuenta" registered in range "A7:A30"
' And calls GetSumPerCatalogCount to get the amount corresponding to that type of account
'

    Dim starDate As Date
    Dim endDate As Date
    
    startDate = range("E2").Value
    endDate = range("E3").Value

    Set countCatalog = range("A7:A30")
    
    Dim startingRow As Integer
    startingRow = 7
    
    For iRow = 1 To countCatalog.Count
        Dim countValue As String
        countValue = Cells(startingRow, 1).Value
        Cells(startingRow, 6).Value = Sheet2.GetSumPerCatalogCount(countValue)
        startingRow = startingRow + 1
    Next iRow
    
End Function
